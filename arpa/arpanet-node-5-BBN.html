<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <title>Arpanet Reconstruction: about BBN, node 5</title>
    <meta name="description" content="Arpanet Reconstruction: about BBN, node 5">
    <meta name="keywords" content="Arpanet, computer history, IMP, BBN, PDP-11, PDP-10, PiDP-1, PiDP-11, PiDP-10">
    <meta name="author" content="Oscar Vermeulen">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.css" />
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Jost:wght@300;400;500;600;700&display=swap');

        :root {
            --cream: #e5dac3;
            --slate: #5b6d7a;
            --dark-slate: #445561;
            --grey-slate: #888888;
            --dark-text: #293238;
            --light-text: #f2ebd5;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Jost', sans-serif;
            background-color: var(--slate);
            color: var(--dark-text);
            line-height: 1.5;
            padding: 15px;
            font-size: 18px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background-color: var(--cream);
            padding: 25px;
        }

        /* Header */
        .header {
            margin-bottom: 30px;
            border-bottom: 2px solid var(--slate);
            padding-bottom: 20px;
        }

        .back-button {
            display: inline-block;
            margin-bottom: 15px;
            padding: 8px 16px;
            background-color: var(--slate);
            color: var(--cream);
            text-decoration: none;
            font-weight: 600;
            font-size: 14px;
            text-transform: uppercase;
            border-radius: 4px;
            transition: background-color 0.2s;
        }

        .back-button:hover {
            background-color: var(--dark-slate);
        }

        .breadcrumb {
            font-size: 16px;
            margin-bottom: 15px;
            color: var(--slate);
            font-weight: 500;
        }

        .breadcrumb a {
            color: var(--slate);
            text-decoration: none;
            border-bottom: 1px dotted var(--slate);
        }

        .breadcrumb a:hover {
            border-bottom: 1px solid var(--slate);
        }

        .breadcrumb-separator {
            margin: 0 8px;
            color: var(--slate);
        }

        .page-title {
            font-size: 32px;
            font-weight: 700;
            color: var(--slate);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* Content sections */
        .section {
            margin-bottom: 35px;
        }

        .section-title {
            font-size: 24px;
            font-weight: 600;
            color: var(--slate);
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border-bottom: 2px solid var(--slate);
            padding-bottom: 10px;
        }

        .section-content {
            padding-left: 2ch;
            line-height: 1.6;
        }

        .section-content p {
            margin-bottom: 12px;
        }

        /* Photo gallery grid */
        .photo-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
            align-items: start;
        }

        .photo-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .photo-item a {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            min-height: 180px;
            background-color: #f5f5f5;
            border: 1px solid #ddd;
            border-radius: 4px;
            overflow: hidden;
        }

        .photo-item img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }

        .photo-caption {
            font-size: 14px;
            color: var(--grey-slate);
            text-align: center;
            font-weight: 500;
        }

        /* Featured image */
        .featured-image {
            display: block;
            width: 100%;
            max-width: 500px;
            height: auto;
            margin: 20px auto;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        /* Two-column photo grid for host details */
        .photo-grid-two-column {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        @media (max-width: 480px) {
            .photo-grid-two-column {
                grid-template-columns: 1fr;
            }
        }

        /* Zoomed map container */
        .zoomed-map-container {
            position: relative;
            display: inline-block;
            width: 100%;
            max-width: 179px;
            height: 179px;
            background-color: #f5f5f5;
            border: 1px solid #ddd;
            border-radius: 4px;
            overflow: hidden;
        }

        .zoomed-map-container img {
            position: absolute;
            display: block;
        }

        .zoomed-map-svg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: auto;
        }

        .zoomed-map-svg ellipse {
            cursor: pointer;
        }

        .node-highlight {
            fill: rgba(255, 0, 0, 0.3);
            stroke: #ff0000;
            stroke-width: 2;
        }

        .host-highlight {
            fill: rgba(255, 140, 0, 0.25);
            stroke: #ff8c00;
            stroke-width: 1.5;
        }

        .neighbor-node {
            fill: rgba(100, 100, 100, 0.15);
            stroke: #888888;
            stroke-width: 1;
            opacity: 0.6;
        }

        /* Maps container - side by side */
        .maps-container {
            display: flex;
            gap: 20px;
            align-items: start;
            flex-wrap: wrap;
        }

        /* Geographic map */
        .geo-map-container {
            position: relative;
            display: inline-block;
            width: 179px;
            height: 179px;
            background-color: #f5f5f5;
            border: 1px solid #ddd;
            border-radius: 4px;
            overflow: hidden;
            flex-shrink: 0;
        }

        /* Host sections */
        .host-section {
            background-color: #f9f9f9;
            padding: 20px;
            margin-bottom: 25px;
            border-left: 4px solid var(--slate);
        }

        .host-title {
            font-size: 22px;
            font-weight: 600;
            color: var(--slate);
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .host-content {
            padding-left: 2ch;
            line-height: 1.6;
        }

        .host-content p {
            margin-bottom: 12px;
        }

        /* Navigation panel */
        .navigation-panel {
            background-color: #f0f0f0;
            padding: 15px;
            margin-bottom: 25px;
            border-radius: 4px;
            font-size: 15px;
        }

        .navigation-panel a {
            color: var(--slate);
            text-decoration: none;
            margin-right: 8px;
            padding: 4px 8px;
            border-bottom: 1px dotted var(--slate);
        }

        .navigation-panel a:hover {
            border-bottom: 1px solid var(--slate);
            background-color: rgba(91, 109, 122, 0.1);
        }

        .nav-separator {
            color: var(--grey-slate);
            margin: 0 6px;
        }

        /* Footer */
        .footer {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 2px solid var(--slate);
            text-align: center;
            color: var(--grey-slate);
            font-size: 16px;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }

            .page-title {
                font-size: 24px;
            }

            .section-title {
                font-size: 20px;
            }

            .photo-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* Sidebars for desktop view */
        .sidebar {
            background-color: var(--slate);
            border: 2px solid var(--cream);
            border-radius: 4px;
            padding: 15px;
            color: var(--light-text);
        }

        .sidebar h3 {
            font-size: 16px;
            font-weight: 600;
            color: var(--cream);
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .sidebar a {
            display: block;
            color: var(--cream);
            text-decoration: none;
            padding: 6px 0;
            border-bottom: 1px dotted var(--cream);
            font-size: 14px;
        }

        .sidebar a:hover {
            color: var(--light-text);
            border-bottom: 1px solid var(--cream);
        }

        /* Host info bar in sidebar */
        .host-info-bar {
            font-size: 0.8em;
            line-height: 1.5;
            margin-bottom: 12px;
            padding-bottom: 12px;
            border-bottom: 1px solid rgba(229, 218, 195, 0.3);
            color: var(--light-text);
        }

        .host-info-item {
            display: block;
            margin-bottom: 6px;
        }

        .host-info-label {
            font-weight: 600;
            display: inline-block;
            min-width: 75px;
        }

        .sidebar-wrapper {
            display: grid;
            grid-template-columns: 1fr 200px;
            gap: 20px;
            align-items: start;
        }

        .sidebar-wrapper-content {
            width: 100%;
        }

        /* Mobile: Sidebars become inline cards */
        @media (max-width: 768px) {
            .sidebar-wrapper {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .sidebar {
                background-color: #f0f0f0;
                border: 2px solid var(--slate);
                color: var(--dark-text);
                margin-bottom: 20px;
            }

            .sidebar h3 {
                color: var(--slate);
            }

            .sidebar a {
                color: var(--slate);
                border-bottom: 1px dotted var(--slate);
            }

            .sidebar a:hover {
                color: var(--dark-slate);
                border-bottom: 1px solid var(--slate);
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 8px;
                font-size: 16px;
            }

            .container {
                padding: 12px;
            }

            .page-title {
                font-size: 20px;
            }

            .section-title {
                font-size: 18px;
            }

            .photo-grid {
                grid-template-columns: 1fr;
            }

            .breadcrumb {
                font-size: 14px;
            }

            .sidebar {
                padding: 12px;
            }

            .sidebar h3 {
                font-size: 14px;
                margin-bottom: 10px;
            }

            .sidebar a {
                font-size: 13px;
                padding: 5px 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <a href="../arpanet_home.html" class="back-button">← Back to Main Page</a>

            <div class="breadcrumb">
                <a href="../arpa.html">The Arpanet Reconstruction Project</a>
                <span class="breadcrumb-separator">&gt;</span>
                <a href="#c1" class="current">Node 5: BBN</a>
            </div>

            <h1 class="page-title" id="c1">Node 5: BBN</h1>
        </div>

        <!-- Navigation Links -->
        <div class="navigation-panel">
            <a href="#c1">Node 5: BBN</a> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| &nbsp;&nbsp;&nbsp;&nbsp;<a href="#c0">Host 5,0: 316 IMP, '?'</a> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| &nbsp;&nbsp;&nbsp;&nbsp;<a href="#c1">Host 5,1: PDP-10 (TENEX), 'BBN-TENEX'</a> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| &nbsp;&nbsp;&nbsp;&nbsp;<a href="#c2">Host 5,2: PDP-10 (TENEXB), 'BBN-TENEXB'</a> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| &nbsp;&nbsp;&nbsp;&nbsp;<a href="#canecdotes">People & Anecdotes</a>
        </div>

        <!-- Introduction Section with Node Links Sidebar -->
        <div class="sidebar-wrapper">
            <div class="sidebar-wrapper-content">
                <div class="section">
                    <h2 class="section-title">Overview</h2>
                    <div class="section-content">
                        When historians trace the beginnings of the Internet, the trail always leads back to one modest building at Bolt Beranek and Newman (BBN) in Cambridge, Massachusetts. In late 1969, BBN hosted one of the first four ARPANET nodes—not just a participant, but the place where the network’s core equipment, the Interface Message Processor (IMP), had actually been designed and built.BBN’s node became a hub for early networking research, experimentation, and operations. The team that ran it were hands-on pioneers, working long nights wiring coaxial cables, debugging packet-switching code, and literally inventing what a computer network should be.<br><br>BBN designed and supplied their IMPs to all the nodes. Also, they managed the IMPs out in the field remotely. And that included doing <i>the first remote firmware updates<i>, and running the NCC (Network Control Center). The latter ran, interestingly, for many years using a 1959 PDP-1, which was also used to develop the IMP firmware. The setup of the BBN node was unique: connected to its regular IMP was a 316 IMP upgraded to be a TIP used for testing software updates and acting as the NCC (Network Control Center), with its own node number 40, and one more TIP, with its own node number 30.
                    </div>
                </div>
            </div>
            <div class="sidebar">
                <h3>Node Links</h3>
                <a href="#">BBN Home</a><br>
<a href="#">BBN-TENEX Information</a><br>
            </div>
        </div>

        <!-- Photo Gallery -->
        <div class="section">


            <div class="photo-grid">

					<!-- Maps Container -->
					<div class="maps-container">
						<!-- Zoomed ARPANET Map -->
						<div class="zoomed-map-container" id="zoomed-map-container">
							<img src="images/arpa/arpanet1973.jpg" id="zoomed-map-image" alt="ARPANET Node Locations (Zoomed)"/>
							<svg class="zoomed-map-svg" id="zoomed-map-svg" viewBox="0 0 1177 879" preserveAspectRatio="none">
								<!-- SVG elements generated by JavaScript -->
							</svg>
						</div>
					</div>

                <!-- Geographic Map -->
					<div class="geo-map-container" id="geo-map-container"></div>

                <div class="photo-item">
                    <a href="images/arpa/5/building.jpg" target="_blank">
                        <img src="images/arpa/5/building.jpg" alt="BBN Campus" />
                    </a>
                </div>
                <div class="photo-item">
                    <a href="images/arpa/5/room.jpg" target="_blank">
                        <img src="images/arpa/5/room.jpg" alt="Server Room" />
                    </a>
                </div>
            </div>
        </div>

        <!-- Additional Information -->
        <div class="section">
            <div class="section-content">
                The centerpiece of the node was the IMP, built from rugged Honeywell DDP-516 minicomputers. These machines were chosen because they were fast for their time, durable, and could run continuously without babysitting. Each IMP served as a small, dedicated packet switch—something entirely new in the late 1960s.<br><br>BBN’s IMP, like all of the early ones, connected to local host computers through 1822 interfaces (named after the protocol BBN devised). The hosts attached at BBN varied over time, but the early ones typically included:
            </div>
        </div>

        <!-- Host Sections -->
        
        <div class="host-section" id="c0">
            <h2 class="host-title">Host 5,0: 316 IMP</h2>

            <div class="sidebar-wrapper">
                <div class="sidebar-wrapper-content">
                    <div class="host-content">
                        The PDP-10 became the backbone machine at BBN for network software. Many early network tools, including early mail transfer experiments and resource-sharing tests, were run on this system. It supported multiple users over terminals and was the main machine on which:<br>- ARPANET protocols were tested<br>- early email software was written and debugged<br>- host-to-host communication experiments were performed
                    </div>

                    <img class="featured-image" src="" alt="316 IMP" data-image-path="images/arpa/5/host-0-0" />
                </div>
                <div class="sidebar">
                    <div class="host-info-bar">
                        <div class="host-info-item"><span class="host-info-label">Name:</span> ?</div>
                        <div class="host-info-item"><span class="host-info-label">Computer:</span> TIP</div>
                        <div class="host-info-item"><span class="host-info-label">OS:</span> TIP</div>
                        <div class="host-info-item"><span class="host-info-label">Role:</span> User</div>
                    </div>
                    <h3>316 IMP Links</h3>
                    <a href="#">PDP-1</a><br><a href="#">PDP-1 at BBN</a><br>
                </div>
            </div>

            <div class="host-content">
                Et earum rerum hic tenetur a sapiente delectus, ut aut reiciendis voluptatibus maiores.
            </div>

            <div class="photo-grid-two-column">
                <div class="photo-item">
                    <a href="" target="_blank" class="host-image-link" data-image-path="images/arpa/5/host-0-1">
                        <img src="" alt="316 IMP" data-image-path="images/arpa/5/host-0-1" />
                    </a>
                </div>
                <div class="photo-item">
                    <a href="" target="_blank" class="host-image-link" data-image-path="images/arpa/5/host-0-2">
                        <img src="" alt="316 IMP" data-image-path="images/arpa/5/host-0-2" />
                    </a>
                </div>
            </div>

            <div class="host-content">
                Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium.
            </div>
        </div>
        

        <div class="host-section" id="c1">
            <h2 class="host-title">Host 5,1: PDP-10 (TENEX)</h2>

            <div class="sidebar-wrapper">
                <div class="sidebar-wrapper-content">
                    <div class="host-content">
                        BBN had a legendary DEC PDP-1, used for research and algorithm development. It wasn’t a production system so much as a platform for trying new ideas—visual displays, AI experiments, and even interactive graphics.<br>The PDP-1 was used heavily by the group working on packet-routing algorithms and traffic measurement. It was one of the earliest machines ever connected to the network.
                    </div>

                    <img class="featured-image" src="" alt="PDP-10 (TENEX)" data-image-path="images/arpa/5/host-1-0" />
                </div>
                <div class="sidebar">
                    <div class="host-info-bar">
                        <div class="host-info-item"><span class="host-info-label">Name:</span> BBN-TENEX</div>
                        <div class="host-info-item"><span class="host-info-label">Computer:</span> PDP-10</div>
                        <div class="host-info-item"><span class="host-info-label">OS:</span> TENEX</div>
                        <div class="host-info-item"><span class="host-info-label">Role:</span> Server</div>
                    </div>
                    <h3>PDP-10 (TENEX) Links</h3>
                    <a href="#">PDP-10 (TENEX) Information</a><br>
                </div>
            </div>

            <div class="host-content">
                Et earum rerum hic tenetur a sapiente delectus, ut aut reiciendis voluptatibus maiores.
            </div>

            <div class="photo-grid-two-column">
                <div class="photo-item">
                    <a href="" target="_blank" class="host-image-link" data-image-path="images/arpa/5/host-1-1">
                        <img src="" alt="PDP-10 (TENEX)" data-image-path="images/arpa/5/host-1-1" />
                    </a>
                </div>
                <div class="photo-item">
                    <a href="" target="_blank" class="host-image-link" data-image-path="images/arpa/5/host-1-2">
                        <img src="" alt="PDP-10 (TENEX)" data-image-path="images/arpa/5/host-1-2" />
                    </a>
                </div>
            </div>

            <div class="host-content">
                Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium.
            </div>
        </div>
        

        <div class="host-section" id="c2">
            <h2 class="host-title">Host 5,2: PDP-10 (TENEXB)</h2>

            <div class="sidebar-wrapper">
                <div class="sidebar-wrapper-content">
                    <div class="host-content">
                        At vero eos et accusamus et iusto odio dignissimos ducimus qui blanditiis praesentium voluptatum deleniti atque corrupti.
                    </div>

                    <img class="featured-image" src="" alt="PDP-10 (TENEXB)" data-image-path="images/arpa/5/host-2-0" />
                </div>
                <div class="sidebar">
                    <div class="host-info-bar">
                        <div class="host-info-item"><span class="host-info-label">Name:</span> BBN-TENEXB</div>
                        <div class="host-info-item"><span class="host-info-label">Computer:</span> PDP-10</div>
                        <div class="host-info-item"><span class="host-info-label">OS:</span> TENEX</div>
                        <div class="host-info-item"><span class="host-info-label">Role:</span> limited Server</div>
                    </div>
                    <h3>PDP-10 (TENEXB) Links</h3>
                    <a href="#">PDP-10 (TENEXB) Information</a><br>
                </div>
            </div>

            <div class="host-content">
                Et earum rerum hic tenetur a sapiente delectus, ut aut reiciendis voluptatibus maiores.
            </div>

            <div class="photo-grid-two-column">
                <div class="photo-item">
                    <a href="" target="_blank" class="host-image-link" data-image-path="images/arpa/5/host-2-1">
                        <img src="" alt="PDP-10 (TENEXB)" data-image-path="images/arpa/5/host-2-1" />
                    </a>
                </div>
                <div class="photo-item">
                    <a href="" target="_blank" class="host-image-link" data-image-path="images/arpa/5/host-2-2">
                        <img src="" alt="PDP-10 (TENEXB)" data-image-path="images/arpa/5/host-2-2" />
                    </a>
                </div>
            </div>

            <div class="host-content">
                Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium.
            </div>
        </div>
        

        <!-- People & Anecdotes Section -->
        <div class="section" id="canecdotes">
            <h2 class="section-title">People & Anecdotes</h2>
            <div class="section-content">
                <h2>Human Side: The Team Behind the Network</h2>
<p>The BBN networking group was small, tightly knit, and famously overworked. They were engineers of a special kind—mathematicians, software developers, hardware specialists, and systems thinkers all rolled together. Many later became legendary figures in computer science.</p>

<h3>Frank Heart – The Quiet Leader</h3>
<p>Frank Heart led the IMP project with a calm, disciplined style. He insisted on reliability, redundancy, and solid engineering—values that shaped the entire design of the network.</p>
<p>He was known for:</p>
<ul>
  <li>defending the team when deadlines seemed impossible</li>
  <li>insisting that the IMPs survive power failures, crashes, and abuse</li>
  <li>keeping the group focused through months of around-the-clock work</li>
</ul>
<p>His leadership directly influenced the Internet’s reputation for resilience.</p>

<h3>Severo Ornstein – Designer of the IMP Hardware</h3>
<p>A hardware wizard, Ornstein helped design the custom interfaces and timing circuits that let the IMP survive real-world conditions. Coworkers joked that he could “hear” logic faults in oscilloscopes the way a musician hears wrong notes.</p>
<p>He later wrote beautifully about working nights soldering, debugging, and thinking about packet-switching long before anyone knew it would take over the world.</p>

<h3>Will Crowther – Software Engineer and Adventurer</h3>
<p>Crowther wrote significant portions of the IMP’s software stack. He later became famous for creating <em>Colossal Cave Adventure</em>, the first text adventure game.</p>
<p>At BBN, he was known for:</p>
<ul>
  <li>sleeping under his desk during long debugging sessions</li>
  <li>rock climbing on weekends</li>
  <li>calm, minimalistic coding that saved the team countless hours</li>
</ul>

<h3>Dave Walden – IMP Systems Programmer</h3>
<p>Walden wrote much of the 1822 host/IMP interface software and host-to-host protocol implementation. He produced extremely clear documentation that made connecting a new host possible.</p>
<p>He once recounted that the documentation for 1822 “was sometimes more carefully read than the Bible” by early ARPANET engineers.</p>

<h3>BBN Receptionist Who Became an ARPANET Operator</h3>
<p>One often-told story is that the BBN receptionist—who had no technical background—was trained to watch the blinking lights of the IMP status indicators so she could alert the engineers when the network behaved strangely. It was an early form of NOC monitoring.</p>

<h2>Anecdotes From the Early Days</h2>
<h3>The First IMP Shipment</h3>
<p>When BBN delivered the very first IMP to UCLA in 1969, they shipped it in a wooden crate. The UCLA team expected a small computer. Instead, they received something the size of a dishwasher—massive, heavy, and industrial-looking.</p>
<p>BBN engineers joked afterward:<br>“That was the moment the Internet physically arrived.”</p>

<h3>Debugging With Paper Tape</h3>
<p>Much of the early IMP code was stored on paper tape. If a tape was dropped or torn, someone had to manually hold it together while feeding it into the reader. Once, after a long night of debugging, Crowther accidentally fed the tape upside-down and backward, creating chaos on the console before they realized the mistake.</p>

<h3>The Network Collapse That Wasn’t</h3>
<p>BBN sometimes received panicked calls from remote sites reporting that 'the network is down.' In one famous case, the BBN team rushed to diagnose the packet logs, only to discover that the user’s terminal paper had simply run out, giving the illusion of a frozen machine.</p>

<h3>BBN’s PDP-10 as a Social Hub</h3>
<p>Because BBN offered a powerful time-sharing system connected to the ARPANET, researchers at other sites often logged in remotely—sometimes for legitimate work, sometimes to chat, experiment, or simply explore.</p>
<p>This created one of the earliest “online communities,” decades before the Web existed.</p>

<h2>Why the BBN Node Matters</h2>
<p>The BBN node wasn’t just another site on the network. It was the birthplace of the devices that made ARPANET possible. It served as:</p>
<ul>
  <li>a development laboratory</li>
  <li>a testbed for protocols</li>
  <li>an unofficial help desk for the entire network</li>
  <li>a gathering place for some of the most creative and driven computer scientists of their time</li>
</ul>
<p>In many ways, the networking culture—collaborative, hacker-friendly, experimentally driven—was shaped by the atmosphere at BBN during these years.</p>
<p>BBN’s node was where the Internet’s DNA was written.</p>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            FOOTER TEXT
        </div>
    </div>

    <script src="assets/js/arpanet-nodes.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.js"></script>
    <script>
        // IMP number for this node details page
        const my_IMP_Number = 5; // BBN

        // Helper function to find and load image in available format
        function loadImage(basePath, imgElement, onFormatFound) {
            const formats = ['webp', 'jpg', 'jpeg', 'png', 'gif'];
            let formatIndex = 0;

            function tryNextFormat() {
                if (formatIndex >= formats.length) {
                    // All formats failed, leave as broken image
                    return;
                }

                const format = formats[formatIndex];
                const src = basePath + '.' + format;
                const testImg = new Image();

                testImg.onload = function() {
                    // Format exists and loads, set it on the actual image
                    imgElement.src = src;
                    // Call the callback with the found format
                    if (onFormatFound) {
                        onFormatFound(format);
                    }
                };

                testImg.onerror = function() {
                    // This format doesn't exist, try next
                    formatIndex++;
                    tryNextFormat();
                };

                testImg.src = src;
            }

            tryNextFormat();
        }

        // Process all images with data-image-path attributes
        function loadAllImages() {
            // Load all images with data-image-path
            document.querySelectorAll('img[data-image-path]').forEach(img => {
                const basePath = img.getAttribute('data-image-path');
                // Find the corresponding link and update it when format is found
                const link = img.closest('a.host-image-link');
                loadImage(basePath, img, function(format) {
                    if (link) {
                        link.href = basePath + '.' + format;
                    }
                });
            });
        }

        // Initialize maps and images when page loads
        function initMapsWhenReady() {
            // Wait for arpanetNodes to be loaded
            if (typeof arpanetNodes === 'undefined') {
                setTimeout(initMapsWhenReady, 100);
                return;
            }
            // Wait for Leaflet to be loaded
            if (typeof L === 'undefined') {
                setTimeout(initMapsWhenReady, 100);
                return;
            }
            initZoomedMap();
            initGeoMap();
            loadAllImages();
        }

        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initMapsWhenReady);
        } else {
            initMapsWhenReady();
        }

        function initZoomedMap() {
            const mapContainer = document.getElementById('zoomed-map-container');
            const mapImage = document.getElementById('zoomed-map-image');
            const mapSvg = document.getElementById('zoomed-map-svg');

            if (!mapContainer || !mapImage || !mapSvg) {
                console.error('Missing elements:', { mapContainer, mapImage, mapSvg });
                return;
            }

            console.log('initZoomedMap running, IMP:', my_IMP_Number, 'arpanetNodes available:', !!arpanetNodes);
            console.log('Image src:', mapImage.src, 'Image loaded:', mapImage.complete, 'Image naturalWidth:', mapImage.naturalWidth);

            // Map dimensions
            const MAP_WIDTH = 1177;
            const MAP_HEIGHT = 879;
            const ZOOM_LEVEL = 0.30; // Show 30% of the map
            const NEIGHBOR_DISTANCE = 280; // pixels

            // Calculate crop region dimensions
            const cropWidth = MAP_WIDTH * ZOOM_LEVEL;
            const cropHeight = MAP_HEIGHT * ZOOM_LEVEL;

            // Find current node by IMP number
            const currentImp = my_IMP_Number;
            let currentNode = arpanetNodes.find(n => {
                if (!n.host) return false;
                const impNumber = n.host % 64;
                return impNumber === currentImp && !n.hostname;
            });

            // If no IMP entry found, use the first host with matching IMP number (e.g., TIP nodes)
            if (!currentNode) {
                currentNode = arpanetNodes.find(n => {
                    if (!n.host) return false;
                    const impNumber = n.host % 64;
                    return impNumber === currentImp;
                });
            }

            if (!currentNode) {
                return;
            }

            // Get all hosts for this node
            const nodeHosts = arpanetNodes.filter(n => {
                if (!n.host) return false;
                const impNumber = n.host % 64;
                return impNumber === currentImp && n.hostname;
            });

            // Calculate bounding box of node and hosts
            let minX = currentNode.x || 500;
            let maxX = currentNode.x || 500;
            let minY = currentNode.y || 400;
            let maxY = currentNode.y || 400;

            console.log('Current node:', currentNode.name1, 'at x:', currentNode.x, 'y:', currentNode.y);
            console.log('Found', nodeHosts.length, 'hosts for this node');

            nodeHosts.forEach(host => {
                console.log('  Host:', host.name2, 'at x:', host.x, 'y:', host.y);
                if (host.x) {
                    minX = Math.min(minX, host.x);
                    maxX = Math.max(maxX, host.x);
                }
                if (host.y) {
                    minY = Math.min(minY, host.y);
                    maxY = Math.max(maxY, host.y);
                }
            });

            // If node has no hosts, expand bounding box around the IMP to ensure proper centering
            if (nodeHosts.length === 0) {
                const bufferX = 50;
                const bufferY = 50;
                minX = Math.max(0, minX - bufferX);
                maxX = Math.min(MAP_WIDTH, maxX + bufferX);
                minY = Math.max(0, minY - bufferY);
                maxY = Math.min(MAP_HEIGHT, maxY + bufferY);
            }

            console.log('Bounding box: x=[' + minX.toFixed(1) + ',' + maxX.toFixed(1) + '] y=[' + minY.toFixed(1) + ',' + maxY.toFixed(1) + ']');

            // Calculate center and expand to show neighbors
            const centerX = (minX + maxX) / 2;
            const centerY = (minY + maxY) / 2;

            console.log('Center: x=' + centerX.toFixed(1) + ' y=' + centerY.toFixed(1));

            // Find neighboring nodes within distance
            const neighbors = arpanetNodes.filter(n => {
                if (!n.x || !n.y || !n.host) return false;
                if (n.host % 64 === currentImp) return false; // Skip current node

                const dist = Math.sqrt(Math.pow(n.x - centerX, 2) + Math.pow(n.y - centerY, 2));
                return dist < NEIGHBOR_DISTANCE;
            });

            // Calculate final crop box centered on the node
            let cropMinX = Math.max(0, centerX - cropWidth / 2);
            let cropMinY = Math.max(0, centerY - cropHeight / 2);
            let cropMaxX = Math.min(MAP_WIDTH, cropMinX + cropWidth);
            let cropMaxY = Math.min(MAP_HEIGHT, cropMinY + cropHeight);

            // Adjust if crop box goes out of bounds
            if (cropMaxX - cropMinX < cropWidth) {
                if (cropMinX === 0) {
                    cropMaxX = Math.min(MAP_WIDTH, cropWidth);
                } else {
                    cropMinX = Math.max(0, cropMaxX - cropWidth);
                }
            }
            if (cropMaxY - cropMinY < cropHeight) {
                if (cropMinY === 0) {
                    cropMaxY = Math.min(MAP_HEIGHT, cropHeight);
                } else {
                    cropMinY = Math.max(0, cropMaxY - cropHeight);
                }
            }

            // Calculate zoom and positioning to show only the crop region
            const containerWidth = mapContainer.offsetWidth || 179;
            const containerHeight = mapContainer.offsetHeight || 179;

            const actualCropWidth = cropMaxX - cropMinX;
            const actualCropHeight = cropMaxY - cropMinY;

            // Calculate scale to fit crop region into container
            const scaleX = containerWidth / actualCropWidth;
            const scaleY = containerHeight / actualCropHeight;
            const scale = Math.min(scaleX, scaleY); // Use smaller scale to fit

            // Scaled image dimensions
            const scaledWidth = MAP_WIDTH * scale;
            const scaledHeight = MAP_HEIGHT * scale;

            // Position to show only the crop region
            const offsetX = -(cropMinX * scale);
            const offsetY = -(cropMinY * scale);

            // Apply transform and positioning
            mapImage.style.width = scaledWidth + 'px';
            mapImage.style.height = scaledHeight + 'px';
            mapImage.style.left = offsetX + 'px';
            mapImage.style.top = offsetY + 'px';

            console.log('Applied zoom:', scale.toFixed(2) + 'x, Crop region: x=[' + cropMinX.toFixed(1) + ',' + cropMaxX.toFixed(1) + '] y=[' + cropMinY.toFixed(1) + ',' + cropMaxY.toFixed(1) + ']');
            console.log('Image styles applied - width:' + scaledWidth + 'px, height:' + scaledHeight + 'px, left:' + offsetX + 'px, top:' + offsetY + 'px');
            console.log('Container computed: offsetWidth=' + mapContainer.offsetWidth + ', offsetHeight=' + mapContainer.offsetHeight);

            // Clear SVG
            mapSvg.innerHTML = '';

            // Scale and position SVG to match image
            mapSvg.style.width = scaledWidth + 'px';
            mapSvg.style.height = scaledHeight + 'px';
            mapSvg.style.left = offsetX + 'px';
            mapSvg.style.top = offsetY + 'px';
            mapSvg.setAttribute('viewBox', `0 0 ${MAP_WIDTH} ${MAP_HEIGHT}`);

            // Neighbor nodes not displayed (grey highlighting removed per user preference)

            // Add current node IMP to SVG
            if (currentNode.x && currentNode.y) {
                const impEllipse = document.createElementNS('http://www.w3.org/2000/svg', 'ellipse');
                impEllipse.setAttribute('cx', currentNode.x);
                impEllipse.setAttribute('cy', currentNode.y);
                impEllipse.setAttribute('rx', currentNode.rx || 38);
                impEllipse.setAttribute('ry', currentNode.ry || 15);
                impEllipse.setAttribute('class', 'node-highlight');
                mapSvg.appendChild(impEllipse);
            }

            // Add host highlights to SVG
            nodeHosts.forEach(host => {
                if (host.x && host.y) {
                    const hostEllipse = document.createElementNS('http://www.w3.org/2000/svg', 'ellipse');
                    hostEllipse.setAttribute('cx', host.x);
                    hostEllipse.setAttribute('cy', host.y);
                    hostEllipse.setAttribute('rx', host.rx || 30);
                    hostEllipse.setAttribute('ry', host.ry || 12);
                    hostEllipse.setAttribute('class', 'host-highlight');
                    mapSvg.appendChild(hostEllipse);
                }
            });
        }

        // Initialize geographic map
        function initGeoMap() {
            const mapContainer = document.getElementById('geo-map-container');
            if (!mapContainer) {
                console.error('Geographic map container not found');
                return;
            }

            // Create map
            const map = L.map(mapContainer);

            // Set bounds to show entire continental USA
            const usaBounds = L.latLngBounds(
                L.latLng(24.5, -125.0),  // Southwest
                L.latLng(49.4, -66.0)    // Northeast
            );
            map.fitBounds(usaBounds);

            // Add OpenStreetMap tiles
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: 'OpenStreetMap',
                maxZoom: 19
            }).addTo(map);

            // Find current node's coordinates
            const currentImp = my_IMP_Number;
            const currentNode = arpanetNodes.find(n => {
                if (!n.host) return false;
                const impNumber = n.host % 64;
                return impNumber === currentImp && !n.hostname;
            });

            // Fallback to any matching entry if no IMP entry
            let nodeCoords = currentNode;
            if (!nodeCoords) {
                nodeCoords = arpanetNodes.find(n => {
                    if (!n.host) return false;
                    const impNumber = n.host % 64;
                    return impNumber === currentImp;
                });
            }

            // Get node's geographic coordinates
            let latitude = 27.70;
            let longitude = -82.764;

            if (nodeCoords && nodeCoords.lat && nodeCoords.lon) {
                latitude = nodeCoords.lat;
                longitude = nodeCoords.lon;
                console.log('Using coordinates from node data: lat=' + latitude + ', lon=' + longitude);
            } else {
                console.log('No coordinates in node data, using default: lat=' + latitude + ', lon=' + longitude);
            }

            // Add marker at node location with red crosshair icon
            const redCrosshairIcon = L.icon({
                iconUrl: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48Y2lyY2xlIGN4PSIxNiIgY3k9IjE2IiByPSI0IiBmaWxsPSJub25lIiBzdHJva2U9IiNmZjAwMDAiIHN0cm9rZS13aWR0aD0iMiIvPjxsaW5lIHgxPSIxNiIgeTE9IjgiIHgyPSIxNiIgeTI9IjAiIHN0cm9rZT0iI2ZmMDAwMCIgc3Ryb2tlLXdpZHRoPSIyIi8+PGxpbmUgeDE9IjE2IiB5MT0iMjQiIHgyPSIxNiIgeTI9IjMyIiBzdHJva2U9IiNmZjAwMDAiIHN0cm9rZS13aWR0aD0iMiIvPjxsaW5lIHgxPSI4IiB5MT0iMTYiIHgyPSIwIiB5Mj0iMTYiIHN0cm9rZT0iI2ZmMDAwMCIgc3Ryb2tlLXdpZHRoPSIyIi8+PGxpbmUgeDE9IjI0IiB5MT0iMTYiIHgyPSIzMiIgeTI9IjE2IiBzdHJva2U9IiNmZjAwMDAiIHN0cm9rZS13aWR0aD0iMiIvPjwvc3ZnPg==',
                iconSize: [32, 32],
                iconAnchor: [16, 16],
                popupAnchor: [0, -16]
            });

            L.marker([latitude, longitude], { icon: redCrosshairIcon })
                .addTo(map)
                .bindPopup(nodeCoords ? (nodeCoords.name1 || 'Node') : 'ARPANET Node');

            console.log('Geographic map initialized at lat=' + latitude + ', lon=' + longitude);
        }
    </script>
</body>
</html>
